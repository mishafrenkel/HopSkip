!function(e){var t={};function s(i){if(t[i])return t[i].exports;var h=t[i]={i:i,l:!1,exports:{}};return e[i].call(h.exports,h,h.exports,s),h.l=!0,h.exports}s.m=e,s.c=t,s.d=function(e,t,i){s.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:i})},s.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},s.t=function(e,t){if(1&t&&(e=s(e)),8&t)return e;if(4&t&&"object"==typeof e&&e&&e.__esModule)return e;var i=Object.create(null);if(s.r(i),Object.defineProperty(i,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var h in e)s.d(i,h,function(t){return e[t]}.bind(null,h));return i},s.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return s.d(t,"a",t),t},s.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},s.p="",s(s.s=0)}([function(e,t,s){"use strict";s.r(t);var i=class{constructor(e){const{img:t,x:s,y:i,width:h,height:a}=e;this.sprite=new Image,this.sprite.src=t,this.width=h,this.height=a,this.X=s,this.Y=i,this.previous_X,this.previous_Y,this.velocity_X=0,this.velocity_Y=0,this.gravity=0,this.weight=0}isColliding(e){return!(this.X>e.X+e.width)&&(!(this.X+this.width<e.X)&&(!(this.Y>e.Y+e.height)&&!(this.Y+this.height<e.Y)))}};var h=class extends i{constructor(e){super(e),this.spriteAnimCounter=0}draw(e){let t=Math.floor(this.spriteAnimCounter)%17;e.drawImage(this.sprite,0,32*t,55,32,this.X,this.Y,55,32)}};var a=class extends i{constructor(e){super(e),this.isHit=!1,this.isLeft=!1,this.isRight=!1,this.isDuck=!1,this.isJump=!1,this.canJump=!1,this.springJump=!1,this.direction="right",this.gravity=1e5,this.weight=.3,this.distance=0,this.spriteAnimCounter=0,this.lives=4,this.update=this.update.bind(this)}addEventHandlers(){document.addEventListener("keydown",function(e){switch(e.keyCode){case 32:case 38:case 87:this.isJump=!0;break;case 37:case 65:this.isLeft=!0;break;case 40:case 83:break;case 39:case 68:this.isRight=!0}}.bind(this),!0),document.addEventListener("keyup",function(e){switch(e.keyCode){case 32:case 38:case 87:this.isJump=!1;break;case 37:case 65:this.isLeft=!1;break;case 40:case 83:break;case 39:case 68:this.isRight=!1}}.bind(this),!0)}draw(e){let t=Math.floor(this.spriteAnimCounter)%8,s=(Math.floor(this.spriteAnimCounter),0),i=0;this.isHit?(s=500,i=0):0===this.velocity_X&&0===this.velocity_Y&&!1===this.isDuck?(s=0,i=0):this.velocity_Y<0||this.velocity_Y>0?(s=250,i=0):0!==this.velocity_X?(s=125,i=t):this.isDuck&&(s=375,i=0);let h=this.X-43;"left"===this.direction&&(e.scale(-1,1),h=-h-125),e.drawImage(this.sprite,125*i,s,125,125,h,this.Y,125,125),"left"===this.direction&&e.scale(-1,1)}update(e){this.isLeft&&(this.velocity_X=-4,this.direction="left"),this.isRight&&(this.velocity_X=4,this.direction="right"),this.distance+=this.velocity_X,this.isLeft||this.isRight||0!==this.velocity_Y||(this.velocity_X=0),this.velocity_Y<this.gravity&&(this.velocity_Y+=this.weight),e.level.platformBlocks().forEach(e=>{this.isColliding(e)&&this.Y+this.height<e.Y+this.velocity_Y&&(this.Y=e.Y-this.height,this.velocity_Y=0)}),e.level.enemies.forEach(t=>{this.isColliding(t)&&this.Y+this.height<t.Y+this.velocity_Y?(this.Y=t.Y-this.height,this.velocity_Y=0,this.X+=1):this.isColliding(t)&&(e.effects.push(new h({img:"assets/explosion.png",x:t.X,y:t.Y,width:55,height:32})),t.reset(),this.isHit=!0,this.velocity_X=-2,this.velocity_Y=-2,this.lives-=1,setTimeout((function(){e.effects.shift()}),1e3),setTimeout((function(){e.player.isHit=!1}),500))});let t=0;for(;t<e.level.consumables.length;){if(this.isColliding(e.level.consumables[t]))switch(e.level.consumables[t].type){case"health":this.lives<6&&(this.lives+=1,e.level.consumables.splice(t,1));break;case"mic":e.level.consumables.splice(t,1),e.level.enemies.forEach(t=>{e.effects.push(new h({img:"assets/explosion.png",x:t.X,y:t.Y,width:55,height:32})),t.reset(),setTimeout((function(){e.effects.shift()}),1e3)})}t++}e.level.fallingBlocks().forEach(e=>{this.isColliding(e)&&this.Y+this.height<e.Y+this.velocity_Y&&(e.gravity=50,e.weight=2.5,e.velocity_Y<e.gravity&&(e.velocity_Y+=e.weight),this.velocity_Y=0,this.canJump=!0),e.Y+=e.velocity_Y}),e.level.springBlocks().forEach(e=>{this.isColliding(e)&&this.Y+this.height<e.Y+this.velocity_Y&&(this.Y=e.Y-this.height,this.velocity_Y=0,this.springJump=!0)}),(this.isJump&&0===this.velocity_Y||this.isJump&&this.canJump)&&(this.velocity_Y=-7.75,this.canJump=!1),this.springJump&&(this.velocity_Y=-12,this.springJump=!1)}};var n=class extends i{constructor(e){super(e),this.type=e.type}};var l=class extends i{constructor(){super({img:"assets/bullet.png",width:58,height:48}),this.weight=58,this.height=48,this.X=this.randomX(),this.Y=this.randomY(),this.isLeft=!0}randomX(){return 50*(Math.floor(9*Math.random())+1)+900}randomY(){return 50*(Math.floor(7*Math.random())+2)}reset(){this.X=this.randomX(),this.Y=this.randomY()}update(){this.X-=3,this.X<=-60&&this.reset()}};var r=class extends i{constructor(e){super(e),this.type=e.type}};class o{constructor(){this.blocks=new Array,this.consumables=new Array,this.enemies=new Array,this.maxEnemies=2}clear(){return this.blocks=[]}numBlocks(){return this.blocks.length}platformBlocks(){return this.blocks.filter(e=>"platform"===e.type)}fallingBlocks(){return this.blocks.filter(e=>"falling"===e.type)}springBlocks(){return this.blocks.filter(e=>"spring"===e.type)}generateEnemies(){for(;this.enemies.length<this.maxEnemies;)this.enemies.push(new l)}updateEnemies(){this.enemies.forEach(e=>{e.update()})}generateConsumables(){Object.keys(g).forEach(e=>{this.consumables.push(new r(g[e]))})}}const g={1:{img:"assets/mic.png",type:"mic",x:500,y:180,width:17,height:35},2:{img:"assets/heart-small.png",type:"health",x:2950,y:100,width:26,height:24},3:{img:"assets/mic.png",type:"mic",x:4350,y:100,width:17,height:35},4:{img:"assets/heart-small.png",type:"health",x:4600,y:100,width:26,height:24},5:{img:"assets/mic.png",type:"mic",x:5e3,y:150,width:17,height:35},6:{img:"assets/heart-small.png",type:"health",x:5300,y:150,width:26,height:24}},c=e=>{let t=Object.assign({type:"platform",num:1,space:0},e);const{level:s,num:i,img:h,x:a,y:l,width:r,height:o,type:g,space:c}=t;let m=0;for(var p=1;p<=i;p++)s.blocks.push(new n({img:h,x:a+m,y:l,width:r,height:o,type:g})),m+=r+c};var m=()=>{const e=new o;return c({level:e,img:"assets/platform.png",num:6,x:96,y:405,width:96,height:11}),c({level:e,img:"assets/platform.png",num:1,x:300,y:325,width:96,height:11}),c({level:e,img:"assets/falling-platform.png",num:1,x:768,y:325,width:96,height:11,type:"falling"}),c({level:e,img:"assets/platform.png",num:2,x:875,y:425,width:96,height:11}),c({level:e,img:"assets/platform.png",x:1200,y:405,width:96,height:11,num:2}),c({level:e,img:"assets/platform.png",num:2,x:1460,y:325,width:96,height:11}),c({level:e,img:"assets/platform.png",x:1300,y:260,width:96,height:11}),c({level:e,img:"assets/platform.png",num:6,x:1460,y:160,width:96,height:11}),c({level:e,img:"assets/spring.png",x:2200,y:420,width:60,height:78,type:"spring",num:2}),c({level:e,img:"assets/platform.png",x:2400,y:260,width:96,height:11,num:2}),c({level:e,img:"assets/spring.png",x:2700,y:420,width:60,height:78,type:"spring",num:2}),c({level:e,img:"assets/falling-platform.png",num:1,x:2900,y:215,width:96,height:11,type:"falling"}),c({level:e,img:"assets/falling-platform.png",num:1,x:3050,y:275,width:96,height:11,type:"falling"}),c({level:e,img:"assets/falling-platform.png",num:1,x:3200,y:360,width:96,height:11,type:"falling"}),c({level:e,img:"assets/platform.png",num:2,x:3330,y:425,width:96,height:11}),c({level:e,img:"assets/falling-platform.png",num:1,x:3600,y:410,width:96,height:11,type:"falling"}),c({level:e,img:"assets/spring.png",num:1,x:3800,y:420,width:60,height:78,type:"spring"}),c({level:e,img:"assets/platform.png",num:2,x:3900,y:225,width:96,height:11}),c({level:e,img:"assets/platform.png",num:2,x:3700,y:125,width:96,height:11}),c({level:e,img:"assets/falling-platform.png",num:1,x:4200,y:260,width:96,height:11,type:"falling",space:170,num:3}),c({level:e,img:"assets/platform.png",num:1,x:4700,y:485,width:96,height:11}),c({level:e,img:"assets/spring.png",x:4900,y:420,width:60,height:78,type:"spring",num:3,space:250}),c({level:e,img:"assets/platform.png",x:5800,y:480,width:96,height:11,num:2,space:200}),c({level:e,img:"assets/platform.png",x:5950,y:380,width:96,height:11}),c({level:e,img:"assets/spring.png",x:6200,y:420,width:60,height:78,type:"spring"}),c({level:e,img:"assets/falling-platform.png",num:1,x:6400,y:360,width:96,height:11,type:"falling"}),c({level:e,img:"assets/platform.png",num:1,x:6600,y:310,width:96,height:11}),c({level:e,img:"assets/platform.png",num:3,x:6800,y:260,width:96,height:11}),c({level:e,img:"assets/platform.png",x:6900,y:160,width:96,height:11}),c({level:e,img:"assets/falling-platform.png",num:1,x:7088,y:260,width:96,height:11,type:"falling"}),c({level:e,img:"assets/spring.png",num:1,x:7400,y:420,width:60,height:78,type:"spring"}),c({level:e,img:"assets/platform.png",num:10,x:7600,y:425,width:96,height:11}),e};var p=class{constructor(){this.music={theme:new Audio("assets/audio/runaway.mp3"),ending:new Audio("assets/audio/through-the-wire.mp3")},this.volume=.5,this.mute=!1,this.addEventHandlers()}playMusic(e){const t=this.music[e];"boolean"==typeof t.loop?t.loop=!0:t.addEventListener("ended",(function(){this.currentTime=0,this.play()}),!1),t.play()}muteToggle(){if(document.getElementById("mute").classList.toggle("volume-off"),this.mute)for(const e of Object.keys(this.music))this.music[e].muted=!1,this.mute=!1;else for(const e of Object.keys(this.music))this.music[e].muted=!0,this.mute=!0}addEventHandlers(){document.getElementById("mute").addEventListener("click",()=>this.muteToggle(),!0)}};var u=class{constructor(){this.gameCanvas=document.getElementById("canvas"),this.graphics=this.gameCanvas.getContext("2d"),this.sounds=new p,this.effects=[],this.level=m(),this.player=new a({img:"assets/grid-sprite.png",x:120,y:0,width:46,height:94}),this.kim=new i({img:"assets/kim.png",x:8400,y:305,width:48,height:121}),this.enemies=this.level.enemies,this.level.generateEnemies(),this.level.generateConsumables()}update(){this.enemies.forEach(e=>e.X+=-this.player.velocity_X),this.level.consumables.forEach(e=>e.X+=-this.player.velocity_X),this.effects.forEach(e=>e.X+=-this.player.velocity_X),this.kim.X+=-this.player.velocity_X,this.level.blocks.forEach(e=>{e.X+=-this.player.velocity_X}),this.player.Y+=this.player.velocity_Y}render(){this.graphics.clearRect(0,0,this.gameCanvas.width,this.gameCanvas.height);for(var e=0;e<this.player.lives;e++){let t=new Image;t.src="assets/heart.png",this.graphics.drawImage(t,50*e+10,10)}for(e=0;e<this.level.numBlocks();e++)this.graphics.drawImage(this.level.blocks[e].sprite,this.level.blocks[e].X,this.level.blocks[e].Y);this.enemies.forEach(e=>{this.graphics.drawImage(e.sprite,e.X,e.Y)}),this.level.consumables.forEach(e=>{this.graphics.drawImage(e.sprite,e.X,e.Y)}),this.graphics.drawImage(this.kim.sprite,this.kim.X,this.kim.Y),0===this.player.velocity_X&&0===this.player.velocity_Y||0!==this.player.velocity_X&&(this.player.spriteAnimCounter+=.2),this.effects.forEach(e=>{e.draw(this.graphics),e.spriteAnimCounter+=.31}),this.player.draw(this.graphics)}};document.addEventListener("DOMContentLoaded",()=>{const e=new u;function t(){document.removeEventListener("keydown",t,!0),e.graphics.clearRect(0,0,e.gameCanvas.width,e.gameCanvas.height);let i=new Image;i.src="assets/splash-controls.jpg",i.onload=function(){e.graphics.drawImage(i,0,0)},document.addEventListener("keydown",s,!0)}function s(){document.removeEventListener("keydown",s,!0),e.graphics.clearRect(0,0,e.gameCanvas.width,e.gameCanvas.height);let t=new Image;t.src="assets/splash-crying-kim.png",t.onload=function(){e.graphics.drawImage(t,0,0)},setTimeout(n,2e3)}function i(){document.body.classList.toggle("death"),e.graphics.clearRect(0,0,e.gameCanvas.width,e.gameCanvas.height);let t=new Image;t.src="assets/splash-retry.jpg",t.onload=function(){e.graphics.drawImage(t,0,0)},document.addEventListener("keydown",a,!0)}function h(){document.body.classList.toggle("death");let t=new Image;t.src="assets/splash-credits.jpg",t.onload=function(){e.graphics.drawImage(t,0,0)};let s=0;!function i(){e.graphics.clearRect(0,0,e.gameCanvas.width,e.gameCanvas.height),e.graphics.drawImage(t,0,s),s-=.6;let h=setTimeout(i,1e3/60);s<=-1200&&(clearTimeout(h),function(){e.graphics.clearRect(0,0,e.gameCanvas.width,e.gameCanvas.height);let t=new Image;t.src="assets/splash-thanks.jpg",t.onload=function(){e.graphics.drawImage(t,0,0)},document.addEventListener("keydown",a,!0)}())}()}function a(){document.removeEventListener("keydown",a,!0),e.player.lives=4,e.player.velocity_X=0,e.player.Y=0,e.player.X=120,e.kim.Y=305,e.kim.X=8400,e.level=m();for(var t=0;t<e.level.numBlocks();t++)e.graphics.drawImage(e.level.blocks[t].sprite,e.level.blocks[t].X,e.level.blocks[t].Y);e.enemies=e.level.enemies,e.level.generateEnemies(),e.level.generateConsumables(),document.body.classList.toggle("death"),n()}e.sounds.playMusic("theme"),e.player.addEventHandlers();const n=()=>{document.removeEventListener("keydown",n,!0),e.update(),e.player.update(e),e.level.updateEnemies(e),e.render();var t=setTimeout(n,1e3/60);e.player.isColliding(e.kim)&&(clearTimeout(t),e.sounds.music.theme.pause(),e.sounds.playMusic("ending"),h()),e.player.Y>500&&(clearTimeout(t),i()),0===e.player.lives&&(clearTimeout(t),i())};!function(){let s=new Image;s.src="assets/start-game.jpg",s.onload=function(){e.graphics.drawImage(s,0,0)},document.addEventListener("keydown",t,!0)}()})}]);